This is a backup before fixing the progress calculation